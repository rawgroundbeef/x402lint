<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>x402check — Validate x402 Payment Configs</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
  <style>
    :root {
      --bg-deep: #0a0f14;
      --bg-surface: #111820;
      --bg-elevated: #1a2332;
      --border: #252d3a;
      --text-primary: #e6edf3;
      --text-secondary: #8b949e;
      --text-muted: #5c6670;
      --accent: #00d992;
      --accent-dim: rgba(0, 217, 146, 0.15);
      --error: #f85149;
      --error-dim: rgba(248, 81, 73, 0.15);
      --warning: #d29922;
      --warning-dim: rgba(210, 153, 34, 0.15);
      --info: #58a6ff;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Outfit', -apple-system, BlinkMacSystemFont, sans-serif;
      background: var(--bg-deep);
      color: var(--text-primary);
      line-height: 1.6;
      min-height: 100vh;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }

    .container {
      max-width: 800px;
      margin: 0 auto;
      padding: 48px 24px;
    }

    /* Header */
    .header {
      text-align: center;
      margin-bottom: 40px;
    }

    .logo {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      font-size: 36px;
      font-weight: 700;
      margin-bottom: 8px;
    }

    .logo-402 {
      color: var(--text-primary);
    }

    .logo-check {
      background: linear-gradient(135deg, var(--accent), #00b377);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .logo-icon {
      width: 32px;
      height: 32px;
      background: var(--accent);
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .logo-icon svg {
      width: 20px;
      height: 20px;
      color: var(--bg-deep);
    }

    .tagline {
      color: var(--text-secondary);
      font-size: 16px;
    }

    /* Card */
    .card {
      background: var(--bg-surface);
      border: 1px solid var(--border);
      border-radius: 16px;
      overflow: hidden;
    }

    /* Examples Section */
    .examples-section {
      border-bottom: 1px solid var(--border);
    }

    .examples-header {
      padding: 16px 20px;
      cursor: pointer;
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-weight: 500;
      color: var(--text-secondary);
      transition: background 0.15s;
    }

    .examples-header:hover {
      background: var(--bg-elevated);
    }

    .examples-section[open] .examples-header {
      border-bottom: 1px solid var(--border);
    }

    .examples-section[open] .arrow {
      transform: rotate(90deg);
    }

    .arrow {
      transition: transform 0.15s;
      color: var(--text-muted);
    }

    .examples-content {
      padding: 20px;
      background: rgba(0,0,0,0.2);
    }

    /* Tabs */
    .tabs {
      display: flex;
      gap: 8px;
      margin-bottom: 16px;
      flex-wrap: wrap;
    }

    .tab {
      padding: 8px 14px;
      background: var(--bg-elevated);
      border: 1px solid var(--border);
      border-radius: 8px;
      color: var(--text-secondary);
      font-size: 13px;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.15s;
    }

    .tab:hover {
      border-color: var(--text-muted);
      color: var(--text-primary);
    }

    .tab.active {
      background: var(--accent);
      border-color: var(--accent);
      color: var(--bg-deep);
    }

    /* Code Block */
    .code-block {
      background: var(--bg-deep);
      border: 1px solid var(--border);
      border-radius: 10px;
      padding: 16px;
      font-family: 'JetBrains Mono', monospace;
      font-size: 12px;
      overflow-x: auto;
      margin-bottom: 16px;
      white-space: pre;
      line-height: 1.5;
    }

    .code-block .key { color: #9cdcfe; }
    .code-block .string { color: #ce9178; }
    .code-block .number { color: #b5cea8; }

    .example-helper {
      font-size: 13px;
      color: var(--text-secondary);
      margin-bottom: 12px;
      padding: 12px;
      background: var(--bg-elevated);
      border-radius: 8px;
      border-left: 3px solid var(--info);
    }

    .load-btn {
      padding: 10px 16px;
      background: var(--bg-elevated);
      border: 1px solid var(--border);
      border-radius: 8px;
      color: var(--text-primary);
      font-size: 13px;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.15s;
    }

    .load-btn:hover {
      background: var(--border);
    }

    /* Input Section */
    .input-section {
      padding: 20px;
    }

    .input-wrapper {
      position: relative;
    }

    textarea {
      width: 100%;
      height: 160px;
      background: var(--bg-deep);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 16px;
      font-family: 'JetBrains Mono', monospace;
      font-size: 13px;
      color: var(--text-primary);
      resize: vertical;
      transition: border-color 0.15s;
    }

    textarea::placeholder {
      color: var(--text-muted);
    }

    textarea:focus {
      outline: none;
      border-color: var(--accent);
    }

    /* Controls */
    .controls {
      display: flex;
      gap: 12px;
      margin-top: 16px;
      align-items: center;
      flex-wrap: wrap;
    }

    .method-group {
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .method-label {
      font-size: 13px;
      color: var(--text-secondary);
    }

    select {
      background: var(--bg-elevated);
      border: 1px solid var(--border);
      border-radius: 8px;
      padding: 10px 12px;
      color: var(--text-primary);
      font-family: 'JetBrains Mono', monospace;
      font-size: 13px;
      cursor: pointer;
    }

    select:focus {
      outline: none;
      border-color: var(--accent);
    }

    .validate-btn {
      flex: 1;
      min-width: 140px;
      padding: 12px 24px;
      background: var(--accent);
      border: none;
      border-radius: 10px;
      color: var(--bg-deep);
      font-size: 15px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.15s;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
    }

    .validate-btn:hover {
      filter: brightness(1.1);
    }

    .validate-btn:disabled {
      opacity: 0.6;
      cursor: not-allowed;
    }

    /* Results */
    .results {
      border-top: 1px solid var(--border);
      padding: 20px;
    }

    .results.hidden {
      display: none;
    }

    /* Checklist */
    .checklist {
      margin-bottom: 20px;
    }

    .check-item {
      display: flex;
      align-items: flex-start;
      gap: 10px;
      padding: 8px 0;
      font-size: 14px;
    }

    .check-icon {
      width: 20px;
      height: 20px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-shrink: 0;
      margin-top: 1px;
    }

    .check-icon.pass {
      background: var(--accent-dim);
      color: var(--accent);
    }

    .check-icon.fail {
      background: var(--error-dim);
      color: var(--error);
    }

    .check-icon.warn {
      background: var(--warning-dim);
      color: var(--warning);
    }

    .check-label {
      color: var(--text-primary);
    }

    .check-detail {
      color: var(--text-muted);
      font-size: 12px;
    }

    /* Format Badge */
    .format-badge-section {
      background: var(--bg-elevated);
      border-radius: 10px;
      padding: 16px;
      margin-bottom: 20px;
    }

    .format-row {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
      flex-wrap: wrap;
    }

    .format-badge {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 6px 12px;
      background: var(--bg-deep);
      border-radius: 6px;
      font-size: 12px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .format-badge.v2 {
      color: var(--accent);
    }

    .format-badge.v1, .format-badge.flat {
      color: var(--warning);
    }

    .upgrade-btn {
      padding: 8px 12px;
      background: transparent;
      border: 1px solid var(--border);
      border-radius: 6px;
      color: var(--text-secondary);
      font-size: 12px;
      cursor: pointer;
      transition: all 0.15s;
    }

    .upgrade-btn:hover {
      border-color: var(--accent);
      color: var(--accent);
    }

    /* Parsed Config */
    .parsed-config {
      background: var(--bg-elevated);
      border-radius: 10px;
      padding: 16px;
    }

    .parsed-title {
      font-size: 13px;
      font-weight: 600;
      color: var(--text-secondary);
      margin-bottom: 12px;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .parsed-row {
      display: flex;
      padding: 6px 0;
      font-size: 14px;
      border-bottom: 1px solid var(--border);
    }

    .parsed-row:last-child {
      border-bottom: none;
    }

    .parsed-label {
      width: 100px;
      color: var(--text-muted);
      flex-shrink: 0;
    }

    .parsed-value {
      color: var(--text-primary);
      font-family: 'JetBrains Mono', monospace;
      font-size: 13px;
      word-break: break-all;
    }

    .parsed-value.truncate {
      max-width: 300px;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }

    /* Errors/Warnings */
    .issues-section {
      margin-bottom: 20px;
    }

    .issue-card {
      padding: 12px;
      border-radius: 8px;
      margin-bottom: 8px;
      font-size: 13px;
    }

    .issue-card.error {
      background: var(--error-dim);
      border: 1px solid rgba(248, 81, 73, 0.3);
    }

    .issue-card.warning {
      background: var(--warning-dim);
      border: 1px solid rgba(210, 153, 34, 0.3);
    }

    .issue-field {
      font-family: 'JetBrains Mono', monospace;
      font-weight: 500;
      margin-bottom: 4px;
    }

    .issue-card.error .issue-field {
      color: var(--error);
    }

    .issue-card.warning .issue-field {
      color: var(--warning);
    }

    .issue-message {
      color: var(--text-primary);
      margin-bottom: 4px;
    }

    .issue-fix {
      color: var(--text-secondary);
      display: flex;
      align-items: flex-start;
      gap: 4px;
    }

    .issue-fix span {
      color: var(--accent);
    }

    .response-body-section {
      margin-bottom: 20px;
    }

    .response-body-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 8px;
    }

    .response-body-label {
      font-size: 12px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      color: var(--text-secondary);
    }

    .copy-btn {
      padding: 4px 12px;
      background: var(--bg-elevated);
      border: 1px solid var(--border);
      border-radius: 6px;
      color: var(--text-secondary);
      font-size: 12px;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.15s;
    }

    .copy-btn:hover {
      background: var(--border);
      color: var(--text-primary);
    }

    .copy-btn.copied {
      background: var(--accent-dim);
      border-color: var(--accent);
      color: var(--accent);
    }

    .response-body-section .code-block {
      white-space: pre-wrap;
      word-break: break-word;
      margin-bottom: 0;
    }

    .error-card {
      background: var(--error-dim);
      border: 1px solid rgba(248, 81, 73, 0.3);
      border-radius: 8px;
      padding: 16px;
      margin-bottom: 16px;
      font-size: 13px;
      color: var(--text-primary);
    }

    .error-card pre {
      margin-top: 12px;
      background: var(--bg-deep);
      padding: 12px;
      border-radius: 6px;
      overflow-x: auto;
      font-family: 'JetBrains Mono', monospace;
      font-size: 11px;
      white-space: pre-wrap;
      word-break: break-word;
    }

    /* Status Header */
    .status-header {
      display: flex;
      align-items: center;
      gap: 12px;
      margin-bottom: 20px;
    }

    .status-icon {
      width: 48px;
      height: 48px;
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .status-icon.valid {
      background: var(--accent-dim);
      color: var(--accent);
    }

    .status-icon.invalid {
      background: var(--error-dim);
      color: var(--error);
    }

    .status-text h3 {
      font-size: 20px;
      font-weight: 600;
    }

    .status-text.valid h3 {
      color: var(--accent);
    }

    .status-text.invalid h3 {
      color: var(--error);
    }

    .status-text p {
      font-size: 13px;
      color: var(--text-secondary);
    }

    /* FAQ */
    .faq-section {
      margin-top: 40px;
    }

    .faq-title {
      font-size: 18px;
      font-weight: 600;
      margin-bottom: 16px;
      color: var(--text-primary);
    }

    .faq-item {
      border: 1px solid var(--border);
      border-radius: 10px;
      margin-bottom: 8px;
      overflow: hidden;
    }

    .faq-question {
      padding: 14px 16px;
      cursor: pointer;
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-weight: 500;
      color: var(--text-primary);
      background: var(--bg-surface);
      transition: background 0.15s;
    }

    .faq-question:hover {
      background: var(--bg-elevated);
    }

    .faq-item[open] .faq-question {
      border-bottom: 1px solid var(--border);
    }

    .faq-answer {
      padding: 14px 16px;
      font-size: 14px;
      color: var(--text-secondary);
      background: var(--bg-surface);
      line-height: 1.7;
    }

    .faq-answer code {
      background: var(--bg-deep);
      padding: 2px 6px;
      border-radius: 4px;
      font-family: 'JetBrains Mono', monospace;
      font-size: 12px;
      color: var(--accent);
    }

    .faq-answer a {
      color: var(--info);
      text-decoration: none;
    }

    .faq-answer a:hover {
      text-decoration: underline;
    }

    /* Footer */
    .footer {
      text-align: center;
      padding: 32px 0;
      color: var(--text-muted);
      font-size: 15px;
    }

    .footer a {
      color: var(--info);
      text-decoration: none;
    }

    .footer a:hover {
      text-decoration: underline;
    }

    /* Raw Response */
    .raw-toggle {
      margin-top: 16px;
    }

    .raw-toggle summary {
      font-size: 13px;
      color: var(--text-muted);
      cursor: pointer;
      padding: 8px 0;
    }

    .raw-toggle summary:hover {
      color: var(--text-secondary);
    }

    .raw-content {
      margin-top: 8px;
      background: var(--bg-deep);
      border: 1px solid var(--border);
      border-radius: 8px;
      padding: 12px;
      font-family: 'JetBrains Mono', monospace;
      font-size: 11px;
      color: var(--text-secondary);
      overflow-x: auto;
      max-height: 200px;
      overflow-y: auto;
      white-space: pre;
    }

    /* Request info */
    .request-info {
      font-family: 'JetBrains Mono', monospace;
      font-size: 12px;
      color: var(--text-muted);
      margin-bottom: 16px;
      padding: 10px 12px;
      background: var(--bg-deep);
      border-radius: 8px;
    }

    .request-info .method {
      color: var(--info);
      font-weight: 600;
    }

    /* Verdict Section */
    .verdict-section {
      text-align: center;
      padding: 28px 20px;
      margin-bottom: 20px;
    }

    .verdict-icon {
      width: 56px;
      height: 56px;
      border-radius: 14px;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      margin-bottom: 12px;
    }

    .verdict-icon.valid {
      background: var(--accent-dim);
      color: var(--accent);
    }

    .verdict-icon.invalid {
      background: var(--error-dim);
      color: var(--error);
    }

    .verdict-label {
      font-size: 24px;
      font-weight: 600;
    }

    .verdict-label.valid {
      color: var(--accent);
    }

    .verdict-label.invalid {
      color: var(--error);
    }

    .verdict-counts {
      font-size: 13px;
      color: var(--text-secondary);
      margin-top: 4px;
    }

    .verdict-format {
      margin-top: 16px;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 12px;
    }

    /* Status Badges */
    .status-badges {
      display: flex;
      justify-content: center;
      gap: 8px;
      margin-top: 16px;
      flex-wrap: wrap;
    }

    .badge {
      display: inline-flex;
      align-items: center;
      gap: 4px;
      padding: 4px 8px;
      border-radius: 4px;
      font-size: 11px;
      font-weight: 600;
      text-transform: uppercase;
    }

    .badge-pass {
      background: var(--accent-dim);
      color: var(--accent);
    }

    .badge-fail {
      background: var(--error-dim);
      color: var(--error);
    }

    /* Collapsible Response Body */
    .response-body-wrapper {
      position: relative;
      overflow: hidden;
    }

    .response-body-wrapper.response-body-collapsed {
      max-height: 100px;
    }

    .response-body-wrapper.response-body-collapsed::after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      height: 40px;
      background: linear-gradient(transparent, var(--bg-deep));
      pointer-events: none;
    }

    .response-body-wrapper.response-body-expanded .code-block {
      max-height: 400px;
      overflow-y: auto;
    }

    .response-body-toggle {
      padding: 8px 0;
      font-size: 13px;
      color: var(--text-muted);
      cursor: pointer;
      background: none;
      border: none;
      font-family: 'Outfit', sans-serif;
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .response-body-toggle:hover {
      color: var(--text-secondary);
    }

    /* Compact Issues List */
    .issues-list {
      background: var(--bg-elevated);
      border-radius: 10px;
      padding: 16px;
      margin-bottom: 16px;
    }

    .issues-list-header {
      font-size: 12px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      margin-bottom: 10px;
      padding-bottom: 10px;
      border-bottom: 1px solid var(--border);
    }

    .issues-list-header.errors {
      color: var(--error);
    }

    .issues-list-header.warnings {
      color: var(--warning);
    }

    .issue-row {
      display: flex;
      align-items: baseline;
      gap: 12px;
      padding: 5px 0;
      font-size: 13px;
    }

    .issue-row + .issue-row {
      border-top: 1px solid var(--border);
    }

    .issue-row-label {
      font-family: 'JetBrains Mono', monospace;
      font-size: 12px;
      font-weight: 500;
      min-width: 72px;
      flex-shrink: 0;
    }

    .issue-row.error .issue-row-label {
      color: var(--error);
    }

    .issue-row.warning .issue-row-label {
      color: var(--warning);
    }

    .issue-row-message {
      color: var(--text-primary);
      line-height: 1.4;
    }

    .issue-row-fix {
      color: var(--text-secondary);
    }
  </style>
</head>
<body>
  <div class="container">
    <!-- Header -->
    <header class="header">
      <div class="logo">
        <span class="logo-icon">
          <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M5 13l4 4L19 7"/></svg>
        </span>
        <span class="logo-402">x402</span><span class="logo-check">check</span>
      </div>
      <p class="tagline">Validate your x402 payment config in seconds</p>
    </header>

    <!-- Main Card -->
    <div class="card">
      <!-- Examples -->
      <details class="examples-section">
        <summary class="examples-header">
          <span>See Example Configs</span>
          <span class="arrow">▶</span>
        </summary>
        <div class="examples-content">
          <div class="tabs">
            <button class="tab active" data-tab="v2">v2 (Recommended)</button>
            <button class="tab" data-tab="v1">v1</button>
            <button class="tab" data-tab="flat">Flat (Legacy)</button>
            <button class="tab" data-tab="marketplace">+ Marketplace</button>
          </div>

          <div id="example-v2" class="example-panel">
            <div class="code-block">{
  <span class="key">"x402Version"</span>: <span class="number">2</span>,
  <span class="key">"resource"</span>: {
    <span class="key">"url"</span>: <span class="string">"https://api.example.com/endpoint"</span>
  },
  <span class="key">"accepts"</span>: [{
    <span class="key">"scheme"</span>: <span class="string">"exact"</span>,
    <span class="key">"network"</span>: <span class="string">"solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp"</span>,
    <span class="key">"payTo"</span>: <span class="string">"5F5Yy9qJov8xK67vEWRoZHppWHEmH3WuG7mSfvLuqUTz"</span>,
    <span class="key">"asset"</span>: <span class="string">"EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v"</span>,
    <span class="key">"amount"</span>: <span class="string">"25000"</span>,
    <span class="key">"maxTimeoutSeconds"</span>: <span class="number">300</span>
  }]
}</div>
            <div class="example-helper">Canonical v2 format. Recommended for all new endpoints.</div>
          </div>

          <div id="example-v1" class="example-panel" style="display: none;">
            <div class="code-block">{
  <span class="key">"x402Version"</span>: <span class="number">1</span>,
  <span class="key">"accepts"</span>: [{
    <span class="key">"scheme"</span>: <span class="string">"exact"</span>,
    <span class="key">"network"</span>: <span class="string">"solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp"</span>,
    <span class="key">"payTo"</span>: <span class="string">"5F5Yy9qJov8xK67vEWRoZHppWHEmH3WuG7mSfvLuqUTz"</span>,
    <span class="key">"maxAmountRequired"</span>: <span class="string">"25000"</span>,
    <span class="key">"asset"</span>: <span class="string">"EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v"</span>
  }]
}</div>
            <div class="example-helper">v1 format. Uses maxAmountRequired instead of amount. Consider upgrading to v2.</div>
          </div>

          <div id="example-flat" class="example-panel" style="display: none;">
            <div class="code-block">{
  <span class="key">"amount"</span>: <span class="string">"25000"</span>,
  <span class="key">"currency"</span>: <span class="string">"USDC"</span>,
  <span class="key">"network"</span>: <span class="string">"solana"</span>,
  <span class="key">"payTo"</span>: <span class="string">"5F5Yy9qJov8xK67vEWRoZHppWHEmH3WuG7mSfvLuqUTz"</span>
}</div>
            <div class="example-helper">Legacy flat format. Works but deprecated. Click 'Show v2 equivalent' to upgrade.</div>
          </div>

          <div id="example-marketplace" class="example-panel" style="display: none;">
            <div class="code-block">{
  <span class="key">"x402Version"</span>: <span class="number">2</span>,
  <span class="key">"resource"</span>: {
    <span class="key">"url"</span>: <span class="string">"https://api.example.com/endpoint"</span>
  },
  <span class="key">"accepts"</span>: [{
    <span class="key">"scheme"</span>: <span class="string">"exact"</span>,
    <span class="key">"network"</span>: <span class="string">"eip155:8453"</span>,
    <span class="key">"payTo"</span>: <span class="string">"0x1234567890abcdef1234567890abcdef12345678"</span>,
    <span class="key">"asset"</span>: <span class="string">"0x833589fCD6eDb6E08f4c7C32D4f71b54bdA02913"</span>,
    <span class="key">"amount"</span>: <span class="string">"10000"</span>,
    <span class="key">"maxTimeoutSeconds"</span>: <span class="number">300</span>
  }],
  <span class="key">"extensions"</span>: {
    <span class="key">"outputSchema"</span>: {
      <span class="key">"type"</span>: <span class="string">"object"</span>,
      <span class="key">"properties"</span>: { <span class="key">"result"</span>: { <span class="key">"type"</span>: <span class="string">"string"</span> } }
    },
    <span class="key">"metadata"</span>: {
      <span class="key">"name"</span>: <span class="string">"My API"</span>,
      <span class="key">"description"</span>: <span class="string">"Does something useful"</span>,
      <span class="key">"category"</span>: <span class="string">"ai"</span>
    }
  }
}</div>
            <div class="example-helper">v2 + marketplace metadata in extensions. Required for x402jobs listing.</div>
          </div>

          <button class="load-btn" id="load-example">Load into validator</button>
        </div>
      </details>

      <!-- Input -->
      <div class="input-section">
        <div class="input-wrapper">
          <textarea id="input" placeholder="Paste a URL or JSON config..."></textarea>
        </div>

        <div class="controls">
          <div class="method-group">
            <span class="method-label">Method:</span>
            <select id="method">
              <option value="GET">GET</option>
              <option value="POST">POST</option>
              <option value="PUT">PUT</option>
              <option value="DELETE">DELETE</option>
            </select>
          </div>
          <button class="validate-btn" id="validate">
            <svg width="18" height="18" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/></svg>
            Validate
          </button>
        </div>
      </div>

      <!-- Results -->
      <div class="results hidden" id="results"></div>
    </div>

    <!-- FAQ -->
    <div class="faq-section">
      <h2 class="faq-title">FAQ</h2>

      <details class="faq-item">
        <summary class="faq-question">
          <span>What is x402?</span>
          <span class="arrow">▶</span>
        </summary>
        <div class="faq-answer">
          x402 is a protocol for machine-to-machine payments over HTTP. When an endpoint requires payment, it returns HTTP status <code>402 Payment Required</code> with a config describing how to pay. Agents read this config, send payment, then retry with proof.
        </div>
      </details>

      <details class="faq-item">
        <summary class="faq-question">
          <span>What should my endpoint return?</span>
          <span class="arrow">▶</span>
        </summary>
        <div class="faq-answer">
          For unpaid requests: HTTP status <code>402</code> with config in response body (JSON) or <code>PAYMENT-REQUIRED</code> header (base64). After payment verification: return <code>200</code> with your actual response.
        </div>
      </details>

      <details class="faq-item">
        <summary class="faq-question">
          <span>Which chains and formats are supported?</span>
          <span class="arrow">▶</span>
        </summary>
        <div class="faq-answer">
          <strong>Chains:</strong> <code>base</code> (eip155:8453), <code>solana</code> (solana:5eykt...), <code>base-sepolia</code>, <code>solana-devnet</code>, <code>avalanche</code>, and more. Networks use <a href="https://github.com/ChainAgnostic/CAIPs/blob/main/CAIPs/caip-2.md" target="_blank" rel="noopener">CAIP-2</a> identifiers internally.<br><br>
          <strong>Formats:</strong> Three formats are supported: Flat (legacy), v1 (accepts), and v2 (canonical). All work, but v2 is recommended for new endpoints.<br><br>
          Powered by the <a href="https://github.com/rawgroundbeef/x402check" target="_blank" rel="noopener">x402check SDK</a>.
        </div>
      </details>

      <details class="faq-item">
        <summary class="faq-question">
          <span>Why is my config failing?</span>
          <span class="arrow">▶</span>
        </summary>
        <div class="faq-answer">
          Common issues:<br>
          • Missing address or amount<br>
          • Wrong chain name (must be lowercase: <code>solana</code> not <code>Solana</code>)<br>
          • Address format doesn't match chain (base58 for Solana, 0x for Base)<br>
          • Endpoint not returning 402 status
        </div>
      </details>

      <details class="faq-item">
        <summary class="faq-question">
          <span>How do I list on x402jobs?</span>
          <span class="arrow">▶</span>
        </summary>
        <div class="faq-answer">
          Add marketplace metadata (name, description, outputSchema) to your v2 config, then submit at <a href="https://x402jobs.com" target="_blank" rel="noopener">x402jobs.com</a>. Complete listings get better placement.
        </div>
      </details>
    </div>

    <!-- Footer -->
    <footer class="footer">
      Made by <a href="https://x.com/rawgroundbeef" target="_blank" rel="noopener">@rawgroundbeef</a> &nbsp;&middot;&nbsp; <a href="https://github.com/rawgroundbeef/x402check" target="_blank" rel="noopener">GitHub</a> &nbsp;&middot;&nbsp; Powered by <a href="https://openfacilitator.io" target="_blank" rel="noopener">OpenFacilitator</a>
    </footer>
  </div>

  <!-- Scripts: SDK IIFE bundle + input handler with adapter -->
  <!-- TODO: Switch to CDN after npm publish: https://cdn.jsdelivr.net/npm/x402check@0.0.1/dist/index.iife.js -->
  <script src="x402check.iife.js"></script>
  <script src="input.js"></script>

  <script>
    // Elements
    const inputEl = document.getElementById('input');
    const methodEl = document.getElementById('method');
    const validateBtn = document.getElementById('validate');
    const resultsEl = document.getElementById('results');
    const loadExampleBtn = document.getElementById('load-example');

    // Example configs
    const examples = {
      v2: `{
  "x402Version": 2,
  "resource": {
    "url": "https://api.example.com/endpoint"
  },
  "accepts": [{
    "scheme": "exact",
    "network": "solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp",
    "payTo": "5F5Yy9qJov8xK67vEWRoZHppWHEmH3WuG7mSfvLuqUTz",
    "asset": "EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v",
    "amount": "25000",
    "maxTimeoutSeconds": 300
  }]
}`,
      v1: `{
  "x402Version": 1,
  "accepts": [{
    "scheme": "exact",
    "network": "solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp",
    "payTo": "5F5Yy9qJov8xK67vEWRoZHppWHEmH3WuG7mSfvLuqUTz",
    "maxAmountRequired": "25000",
    "asset": "EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v"
  }]
}`,
      flat: `{
  "amount": "25000",
  "currency": "USDC",
  "network": "solana",
  "payTo": "5F5Yy9qJov8xK67vEWRoZHppWHEmH3WuG7mSfvLuqUTz"
}`,
      marketplace: `{
  "x402Version": 2,
  "resource": {
    "url": "https://api.example.com/endpoint"
  },
  "accepts": [{
    "scheme": "exact",
    "network": "eip155:8453",
    "payTo": "0x1234567890abcdef1234567890abcdef12345678",
    "asset": "0x833589fCD6eDb6E08f4c7C32D4f71b54bdA02913",
    "amount": "10000",
    "maxTimeoutSeconds": 300
  }],
  "extensions": {
    "outputSchema": {
      "type": "object",
      "properties": { "result": { "type": "string" } }
    },
    "metadata": {
      "name": "My API",
      "description": "Does something useful",
      "category": "ai"
    }
  }
}`
    };

    let currentTab = 'v2';

    // Tab switching
    document.querySelectorAll('.tab').forEach(tab => {
      tab.addEventListener('click', () => {
        currentTab = tab.dataset.tab;
        document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
        tab.classList.add('active');
        document.querySelectorAll('.example-panel').forEach(p => p.style.display = 'none');
        document.getElementById(`example-${currentTab}`).style.display = 'block';
      });
    });

    // Load example
    loadExampleBtn.addEventListener('click', () => {
      inputEl.value = examples[currentTab];
    });

    // Validate
    validateBtn.addEventListener('click', async () => {
      const value = inputEl.value.trim();
      if (!value) {
        displayError('Please enter a URL or JSON config');
        return;
      }

      validateBtn.disabled = true;
      validateBtn.innerHTML = '<span>Validating...</span>';

      try {
        await handleValidation(value, methodEl.value, displayResults, displayError);
      } catch (e) {
        displayError(e.message);
      } finally {
        validateBtn.disabled = false;
        validateBtn.innerHTML = '<svg width="18" height="18" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/></svg> Validate';
      }
    });

    function displayResults(result) {
      let html = '';
      const validation = result.validation;
      const config = result.config;
      const checks = result.type === 'url' ? result.checks : null;

      if (result.type === 'url') {
        html += `<div class="request-info"><span class="method">${result.method}</span> ${result.url}</div>`;
      }

      if (validation && typeof validation.valid !== 'undefined') {
        // 1. Verdict (always first)
        html += renderVerdict(validation, checks);

        // 2. Response body (collapsed, URL only)
        if (result.type === 'url' && result.rawBody) {
          let formattedBody = result.rawBody;
          try { formattedBody = JSON.stringify(JSON.parse(result.rawBody), null, 2); } catch(e) {}
          html += `
            <div class="response-body-section">
              <div class="response-body-header">
                <span class="response-body-label">Response Body</span>
                <button class="copy-btn" onclick="copyResponseBody(this)">Copy</button>
              </div>
              <div class="response-body-wrapper response-body-collapsed" id="response-body-wrapper">
                <div class="code-block" id="response-body-content">${escapeHtml(formattedBody)}</div>
              </div>
              <button class="response-body-toggle" onclick="toggleResponseBody()">
                <span id="rb-toggle-icon">▼</span> Show full response
              </button>
            </div>`;
        }

        // 3. Errors, warnings, parsed config, raw config
        html += renderDetails(validation, config);
      } else if (result.type === 'url') {
        if (result.config) {
          html += '<div class="error-card"><strong>Config found but validation failed</strong><br>Raw config: <pre>' + escapeHtml(JSON.stringify(result.config, null, 2)) + '</pre></div>';
        } else {
          html += '<div class="error-card"><strong>No payment config found</strong><br>The endpoint returned ' + result.status + ' but no valid JSON config was extracted from the response body or PAYMENT-REQUIRED header.</div>';
        }
      }

      resultsEl.innerHTML = html;
      resultsEl.classList.remove('hidden');
    }

    function renderVerdict(validation, checks) {
      if (!validation || typeof validation.valid === 'undefined') {
        return '<div class="error-card"><strong>Validation error</strong><br>Could not validate the config.</div>';
      }

      const isValid = validation.valid;
      let html = '<div class="verdict-section">';

      // Icon
      html += `<div class="verdict-icon ${isValid ? 'valid' : 'invalid'}">
        ${isValid
          ? '<svg width="28" height="28" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" d="M5 13l4 4L19 7"/></svg>'
          : '<svg width="28" height="28" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" d="M6 18L18 6M6 6l12 12"/></svg>'
        }
      </div>`;

      // Label + counts
      html += `<div class="verdict-label ${isValid ? 'valid' : 'invalid'}">${isValid ? 'Valid' : 'Invalid'}</div>`;
      html += `<div class="verdict-counts">${validation.errors.length} error${validation.errors.length !== 1 ? 's' : ''} · ${validation.warnings.length} warning${validation.warnings.length !== 1 ? 's' : ''}</div>`;

      // Inline status badges (URL checks only)
      if (checks) {
        const badgeOrder = ['returns402', 'hasCors', 'hasConfig', 'hasHeader'];
        const badgeLabels = { returns402: '402', hasCors: 'CORS', hasConfig: 'Body', hasHeader: 'Header' };
        html += '<div class="status-badges">';
        badgeOrder.forEach(key => {
          if (checks[key]) {
            const pass = checks[key].pass;
            html += `<span class="badge ${pass ? 'badge-pass' : 'badge-fail'}">${badgeLabels[key]} ${pass ? '✓' : '✗'}</span>`;
          }
        });
        html += '</div>';
      }

      // Format detection
      const formatLabels = {
        'flat': 'Flat (Legacy)',
        'v1': 'v1 (accepts)',
        'v2': 'v2 (Canonical)',
        'v2-marketplace': 'v2 + Marketplace'
      };
      const formatClass = validation.detectedFormat.startsWith('v2') ? 'v2' : validation.detectedFormat;
      html += `<div class="verdict-format">
        <span class="format-badge ${formatClass}">${formatLabels[validation.detectedFormat] || validation.detectedFormat}</span>
        ${!validation.detectedFormat.startsWith('v2') ? '<button class="upgrade-btn" onclick="showV2Equivalent()">Show v2 equivalent →</button>' : ''}
      </div>`;

      // Help link on invalid
      if (!isValid) {
        html += `<div style="margin-top: 12px;"><a href="#" onclick="document.querySelector('.examples-section').open = true; return false;" style="color: var(--info); font-size: 13px; text-decoration: none;">View example configs →</a></div>`;
      }

      html += '</div>';
      return html;
    }

    function renderDetails(validation, config) {
      if (!validation || typeof validation.valid === 'undefined') return '';

      let html = '';

      // Errors (compact list)
      if (validation.errors.length > 0) {
        html += `<div class="issues-list">
          <div class="issues-list-header errors">Errors (${validation.errors.length})</div>`;
        validation.errors.forEach(err => {
          html += `<div class="issue-row error">
            <span class="issue-row-label">${err.field}</span>
            <span class="issue-row-message">${err.message}${err.fix ? ' <span class="issue-row-fix">→ ' + err.fix + '</span>' : ''}</span>
          </div>`;
        });
        html += '</div>';
      }

      // Warnings (compact list)
      if (validation.warnings.length > 0) {
        html += `<div class="issues-list">
          <div class="issues-list-header warnings">Warnings (${validation.warnings.length})</div>`;
        validation.warnings.forEach(warn => {
          html += `<div class="issue-row warning">
            <span class="issue-row-label">${warn.field}</span>
            <span class="issue-row-message">${warn.message}${warn.fix ? ' <span class="issue-row-fix">→ ' + warn.fix + '</span>' : ''}</span>
          </div>`;
        });
        html += '</div>';
      }

      // Parsed config summary
      if (validation.normalized && validation.normalized.payments && validation.normalized.payments.length > 0) {
        const p = validation.normalized.payments[0];
        const amount = p._normalizedAmount || normalizeAmount(p.minAmount);
        html += `
          <div class="parsed-config">
            <div class="parsed-title">Parsed Config</div>
            <div class="parsed-row">
              <span class="parsed-label">Chain</span>
              <span class="parsed-value">${p.chain || '—'}</span>
            </div>
            <div class="parsed-row">
              <span class="parsed-label">Address</span>
              <span class="parsed-value truncate">${p.address || '—'}</span>
            </div>
            <div class="parsed-row">
              <span class="parsed-label">Amount</span>
              <span class="parsed-value">${amount.normalized || '—'} ${p.asset || ''} ${amount.isMicroUnits ? `(${amount.original} micro)` : ''}</span>
            </div>
            <div class="parsed-row">
              <span class="parsed-label">Asset</span>
              <span class="parsed-value">${p.asset || '—'}</span>
            </div>
            <div class="parsed-row">
              <span class="parsed-label">Marketplace</span>
              <span class="parsed-value">${validation.normalized.metadata ? '✓ Ready' : '✗ No metadata'}</span>
            </div>
          </div>`;
      }

      // Raw config
      if (config) {
        html += `
          <details class="raw-toggle">
            <summary>View raw config</summary>
            <div class="raw-content">${escapeHtml(JSON.stringify(config, null, 2))}</div>
          </details>`;
      }

      return html;
    }

    function displayError(message) {
      resultsEl.innerHTML = `
        <div class="verdict-section">
          <div class="verdict-icon invalid">
            <svg width="28" height="28" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"/>
            </svg>
          </div>
          <div class="verdict-label invalid">Error</div>
          <div class="verdict-counts">${message}</div>
          <div style="margin-top: 12px;">
            <a href="#" onclick="document.querySelector('.examples-section').open = true; return false;" style="color: var(--info); font-size: 13px; text-decoration: none;">View example configs →</a>
          </div>
        </div>`;
      resultsEl.classList.remove('hidden');
    }

    function copyResponseBody(btn) {
      const content = document.getElementById('response-body-content');
      if (content) {
        navigator.clipboard.writeText(content.textContent).then(() => {
          btn.textContent = 'Copied!';
          btn.classList.add('copied');
          setTimeout(() => {
            btn.textContent = 'Copy';
            btn.classList.remove('copied');
          }, 2000);
        });
      }
    }

    function toggleResponseBody() {
      const wrapper = document.getElementById('response-body-wrapper');
      const toggle = wrapper.closest('.response-body-section').querySelector('.response-body-toggle');
      if (wrapper.classList.contains('response-body-collapsed')) {
        wrapper.classList.remove('response-body-collapsed');
        wrapper.classList.add('response-body-expanded');
        toggle.innerHTML = '<span>▲</span> Hide full response';
      } else {
        wrapper.classList.remove('response-body-expanded');
        wrapper.classList.add('response-body-collapsed');
        toggle.innerHTML = '<span>▼</span> Show full response';
      }
    }

    function escapeHtml(text) {
      const div = document.createElement('div');
      div.textContent = text;
      return div.innerHTML;
    }

    function showV2Equivalent() {
      try {
        const config = JSON.parse(inputEl.value);
        const normalized = window.x402Validate.normalize(config);
        if (normalized) {
          inputEl.value = JSON.stringify(normalized, null, 2);
          validateBtn.click();
        }
      } catch (e) {
        // ignore
      }
    }
  </script>
</body>
</html>
